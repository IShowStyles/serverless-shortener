"use strict";var no=Object.create;var he=Object.defineProperty,so=Object.defineProperties,io=Object.getOwnPropertyDescriptor,oo=Object.getOwnPropertyDescriptors,ao=Object.getOwnPropertyNames,rt=Object.getOwnPropertySymbols,co=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable;var tt=(e,r,t)=>r in e?he(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,st=(e,r)=>{for(var t in r||(r={}))nt.call(r,t)&&tt(e,t,r[t]);if(rt)for(var t of rt(r))uo.call(r,t)&&tt(e,t,r[t]);return e},it=(e,r)=>so(e,oo(r));var h=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),fo=(e,r)=>{for(var t in r)he(e,t,{get:r[t],enumerable:!0})},ot=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of ao(r))!nt.call(e,s)&&s!==t&&he(e,s,{get:()=>r[s],enumerable:!(n=io(r,s))||n.enumerable});return e};var ir=(e,r,t)=>(t=e!=null?no(co(e)):{},ot(r||!e||!e.__esModule?he(t,"default",{value:e,enumerable:!0}):t,e)),lo=e=>ot(he({},"__esModule",{value:!0}),e);var v=(e,r,t)=>new Promise((n,s)=>{var i=c=>{try{a(t.next(c))}catch(u){s(u)}},o=c=>{try{a(t.throw(c))}catch(u){s(u)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);a((t=t.apply(e,r)).next())});var at=h((Mh,ho)=>{ho.exports={name:"dotenv",version:"16.3.1",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://github.com/motdotla/dotenv?sponsor=1",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var lt=h((Hh,C)=>{var ct=require("fs"),ar=require("path"),po=require("os"),mo=require("crypto"),Eo=at(),cr=Eo.version,go=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function yo(e){let r={},t=e.toString();t=t.replace(/\r\n?/mg,`
`);let n;for(;(n=go.exec(t))!=null;){let s=n[1],i=n[2]||"";i=i.trim();let o=i[0];i=i.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),o==='"'&&(i=i.replace(/\\n/g,`
`),i=i.replace(/\\r/g,"\r")),r[s]=i}return r}function vo(e){let r=ft(e),t=I.configDotenv({path:r});if(!t.parsed)throw new Error(`MISSING_DATA: Cannot parse ${r} for an unknown reason`);let n=ut(e).split(","),s=n.length,i;for(let o=0;o<s;o++)try{let a=n[o].trim(),c=bo(t,a);i=I.decrypt(c.ciphertext,c.key);break}catch(a){if(o+1>=s)throw a}return I.parse(i)}function So(e){console.log(`[dotenv@${cr}][INFO] ${e}`)}function wo(e){console.log(`[dotenv@${cr}][WARN] ${e}`)}function or(e){console.log(`[dotenv@${cr}][DEBUG] ${e}`)}function ut(e){return e&&e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function bo(e,r){let t;try{t=new URL(r)}catch(a){throw a.code==="ERR_INVALID_URL"?new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=development"):a}let n=t.password;if(!n)throw new Error("INVALID_DOTENV_KEY: Missing key part");let s=t.searchParams.get("environment");if(!s)throw new Error("INVALID_DOTENV_KEY: Missing environment part");let i=`DOTENV_VAULT_${s.toUpperCase()}`,o=e.parsed[i];if(!o)throw new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${i} in your .env.vault file.`);return{ciphertext:o,key:n}}function ft(e){let r=ar.resolve(process.cwd(),".env");return e&&e.path&&e.path.length>0&&(r=e.path),r.endsWith(".vault")?r:`${r}.vault`}function Io(e){return e[0]==="~"?ar.join(po.homedir(),e.slice(1)):e}function To(e){So("Loading env from encrypted .env.vault");let r=I._parseVault(e),t=process.env;return e&&e.processEnv!=null&&(t=e.processEnv),I.populate(t,r,e),{parsed:r}}function Ro(e){let r=ar.resolve(process.cwd(),".env"),t="utf8",n=!!(e&&e.debug);e&&(e.path!=null&&(r=Io(e.path)),e.encoding!=null&&(t=e.encoding));try{let s=I.parse(ct.readFileSync(r,{encoding:t})),i=process.env;return e&&e.processEnv!=null&&(i=e.processEnv),I.populate(i,s,e),{parsed:s}}catch(s){return n&&or(`Failed to load ${r} ${s.message}`),{error:s}}}function Ao(e){let r=ft(e);return ut(e).length===0?I.configDotenv(e):ct.existsSync(r)?I._configVault(e):(wo(`You set DOTENV_KEY but you are missing a .env.vault file at ${r}. Did you forget to build it?`),I.configDotenv(e))}function xo(e,r){let t=Buffer.from(r.slice(-64),"hex"),n=Buffer.from(e,"base64"),s=n.slice(0,12),i=n.slice(-16);n=n.slice(12,-16);try{let o=mo.createDecipheriv("aes-256-gcm",t,s);return o.setAuthTag(i),`${o.update(n)}${o.final()}`}catch(o){let a=o instanceof RangeError,c=o.message==="Invalid key length",u=o.message==="Unsupported state or unable to authenticate data";if(a||c){let l="INVALID_DOTENV_KEY: It must be 64 characters long (or more)";throw new Error(l)}else if(u){let l="DECRYPTION_FAILED: Please check your DOTENV_KEY";throw new Error(l)}else throw console.error("Error: ",o.code),console.error("Error: ",o.message),o}}function $o(e,r,t={}){let n=!!(t&&t.debug),s=!!(t&&t.override);if(typeof r!="object")throw new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");for(let i of Object.keys(r))Object.prototype.hasOwnProperty.call(e,i)?(s===!0&&(e[i]=r[i]),n&&or(s===!0?`"${i}" is already defined and WAS overwritten`:`"${i}" is already defined and was NOT overwritten`)):e[i]=r[i]}var I={configDotenv:Ro,_configVault:To,_parseVault:vo,config:Ao,decrypt:xo,parse:yo,populate:$o};C.exports.configDotenv=I.configDotenv;C.exports._configVault=I._configVault;C.exports._parseVault=I._parseVault;C.exports.config=I.config;C.exports.decrypt=I.decrypt;C.exports.parse=I.parse;C.exports.populate=I.populate;C.exports=I});var ee=h((ur,Et)=>{var Ne=require("buffer"),V=Ne.Buffer;function mt(e,r){for(var t in e)r[t]=e[t]}V.from&&V.alloc&&V.allocUnsafe&&V.allocUnsafeSlow?Et.exports=Ne:(mt(Ne,ur),ur.Buffer=Z);function Z(e,r,t){return V(e,r,t)}mt(V,Z);Z.from=function(e,r,t){if(typeof e=="number")throw new TypeError("Argument must not be a number");return V(e,r,t)};Z.alloc=function(e,r,t){if(typeof e!="number")throw new TypeError("Argument must be a number");var n=V(e);return r!==void 0?typeof t=="string"?n.fill(r,t):n.fill(r):n.fill(0),n};Z.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return V(e)};Z.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Ne.SlowBuffer(e)}});var fr=h((rp,gt)=>{var Le=ee().Buffer,No=require("stream"),Lo=require("util");function Oe(e){if(this.buffer=null,this.writable=!0,this.readable=!0,!e)return this.buffer=Le.alloc(0),this;if(typeof e.pipe=="function")return this.buffer=Le.alloc(0),e.pipe(this),this;if(e.length||typeof e=="object")return this.buffer=e,this.writable=!1,process.nextTick(function(){this.emit("end",e),this.readable=!1,this.emit("close")}.bind(this)),this;throw new TypeError("Unexpected data type ("+typeof e+")")}Lo.inherits(Oe,No);Oe.prototype.write=function(r){this.buffer=Le.concat([this.buffer,Le.from(r)]),this.emit("data",r)};Oe.prototype.end=function(r){r&&this.write(r),this.emit("end",r),this.emit("close"),this.writable=!1,this.readable=!1};gt.exports=Oe});var vt=h((tp,yt)=>{"use strict";var pe=require("buffer").Buffer,lr=require("buffer").SlowBuffer;yt.exports=qe;function qe(e,r){if(!pe.isBuffer(e)||!pe.isBuffer(r)||e.length!==r.length)return!1;for(var t=0,n=0;n<e.length;n++)t|=e[n]^r[n];return t===0}qe.install=function(){pe.prototype.equal=lr.prototype.equal=function(r){return qe(this,r)}};var Oo=pe.prototype.equal,qo=lr.prototype.equal;qe.restore=function(){pe.prototype.equal=Oo,lr.prototype.equal=qo}});var wt=h((np,St)=>{"use strict";function hr(e){var r=(e/8|0)+(e%8===0?0:1);return r}var _o={ES256:hr(256),ES384:hr(384),ES512:hr(521)};function jo(e){var r=_o[e];if(r)return r;throw new Error('Unknown algorithm "'+e+'"')}St.exports=jo});var $t=h((sp,xt)=>{"use strict";var _e=ee().Buffer,It=wt(),je=128,Tt=0,Do=32,Po=16,Co=2,Rt=Po|Do|Tt<<6,De=Co|Tt<<6;function Vo(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function At(e){if(_e.isBuffer(e))return e;if(typeof e=="string")return _e.from(e,"base64");throw new TypeError("ECDSA signature must be a Base64 string or a Buffer")}function Bo(e,r){e=At(e);var t=It(r),n=t+1,s=e.length,i=0;if(e[i++]!==Rt)throw new Error('Could not find expected "seq"');var o=e[i++];if(o===(je|1)&&(o=e[i++]),s-i<o)throw new Error('"seq" specified length of "'+o+'", only "'+(s-i)+'" remaining');if(e[i++]!==De)throw new Error('Could not find expected "int" for "r"');var a=e[i++];if(s-i-2<a)throw new Error('"r" specified length of "'+a+'", only "'+(s-i-2)+'" available');if(n<a)throw new Error('"r" specified length of "'+a+'", max of "'+n+'" is acceptable');var c=i;if(i+=a,e[i++]!==De)throw new Error('Could not find expected "int" for "s"');var u=e[i++];if(s-i!==u)throw new Error('"s" specified length of "'+u+'", expected "'+(s-i)+'"');if(n<u)throw new Error('"s" specified length of "'+u+'", max of "'+n+'" is acceptable');var l=i;if(i+=u,i!==s)throw new Error('Expected to consume entire buffer, but "'+(s-i)+'" bytes remain');var f=t-a,g=t-u,m=_e.allocUnsafe(f+a+g+u);for(i=0;i<f;++i)m[i]=0;e.copy(m,i,c+Math.max(-f,0),c+a),i=t;for(var b=i;i<b+g;++i)m[i]=0;return e.copy(m,i,l+Math.max(-g,0),l+u),m=m.toString("base64"),m=Vo(m),m}function bt(e,r,t){for(var n=0;r+n<t&&e[r+n]===0;)++n;var s=e[r+n]>=je;return s&&--n,n}function Go(e,r){e=At(e);var t=It(r),n=e.length;if(n!==t*2)throw new TypeError('"'+r+'" signatures must be "'+t*2+'" bytes, saw "'+n+'"');var s=bt(e,0,t),i=bt(e,t,e.length),o=t-s,a=t-i,c=1+1+o+1+1+a,u=c<je,l=_e.allocUnsafe((u?2:3)+c),f=0;return l[f++]=Rt,u?l[f++]=c:(l[f++]=je|1,l[f++]=c&255),l[f++]=De,l[f++]=o,s<0?(l[f++]=0,f+=e.copy(l,f,0,t)):f+=e.copy(l,f,s,t),l[f++]=De,l[f++]=a,i<0?(l[f++]=0,e.copy(l,f,t)):e.copy(l,f,t+i),l}xt.exports={derToJose:Bo,joseToDer:Go}});var mr=h((ip,Ct)=>{var ko=vt(),te=ee().Buffer,P=require("crypto"),Lt=$t(),Nt=require("util"),Fo=`"%s" is not a valid algorithm.
  Supported algorithms are:
  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".`,de="secret must be a string or buffer",re="key must be a string or a buffer",Uo="key must be a string, a buffer or an object",pr=typeof P.createPublicKey=="function";pr&&(re+=" or a KeyObject",de+="or a KeyObject");function Ot(e){if(!te.isBuffer(e)&&typeof e!="string"&&(!pr||typeof e!="object"||typeof e.type!="string"||typeof e.asymmetricKeyType!="string"||typeof e.export!="function"))throw j(re)}function qt(e){if(!te.isBuffer(e)&&typeof e!="string"&&typeof e!="object")throw j(Uo)}function Ko(e){if(!te.isBuffer(e)){if(typeof e=="string")return e;if(!pr||typeof e!="object"||e.type!=="secret"||typeof e.export!="function")throw j(de)}}function dr(e){return e.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _t(e){e=e.toString();var r=4-e.length%4;if(r!==4)for(var t=0;t<r;++t)e+="=";return e.replace(/\-/g,"+").replace(/_/g,"/")}function j(e){var r=[].slice.call(arguments,1),t=Nt.format.bind(Nt,e).apply(null,r);return new TypeError(t)}function Mo(e){return te.isBuffer(e)||typeof e=="string"}function me(e){return Mo(e)||(e=JSON.stringify(e)),e}function jt(e){return function(t,n){Ko(n),t=me(t);var s=P.createHmac("sha"+e,n),i=(s.update(t),s.digest("base64"));return dr(i)}}function Ho(e){return function(t,n,s){var i=jt(e)(t,s);return ko(te.from(n),te.from(i))}}function Dt(e){return function(t,n){qt(n),t=me(t);var s=P.createSign("RSA-SHA"+e),i=(s.update(t),s.sign(n,"base64"));return dr(i)}}function Pt(e){return function(t,n,s){Ot(s),t=me(t),n=_t(n);var i=P.createVerify("RSA-SHA"+e);return i.update(t),i.verify(s,n,"base64")}}function Xo(e){return function(t,n){qt(n),t=me(t);var s=P.createSign("RSA-SHA"+e),i=(s.update(t),s.sign({key:n,padding:P.constants.RSA_PKCS1_PSS_PADDING,saltLength:P.constants.RSA_PSS_SALTLEN_DIGEST},"base64"));return dr(i)}}function Wo(e){return function(t,n,s){Ot(s),t=me(t),n=_t(n);var i=P.createVerify("RSA-SHA"+e);return i.update(t),i.verify({key:s,padding:P.constants.RSA_PKCS1_PSS_PADDING,saltLength:P.constants.RSA_PSS_SALTLEN_DIGEST},n,"base64")}}function Yo(e){var r=Dt(e);return function(){var n=r.apply(null,arguments);return n=Lt.derToJose(n,"ES"+e),n}}function Jo(e){var r=Pt(e);return function(n,s,i){s=Lt.joseToDer(s,"ES"+e).toString("base64");var o=r(n,s,i);return o}}function zo(){return function(){return""}}function Qo(){return function(r,t){return t===""}}Ct.exports=function(r){var t={hs:jt,rs:Dt,ps:Xo,es:Yo,none:zo},n={hs:Ho,rs:Pt,ps:Wo,es:Jo,none:Qo},s=r.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/i);if(!s)throw j(Fo,r);var i=(s[1]||s[3]).toLowerCase(),o=s[2];return{sign:t[i](o),verify:n[i](o)}}});var Er=h((op,Vt)=>{var Zo=require("buffer").Buffer;Vt.exports=function(r){return typeof r=="string"?r:typeof r=="number"||Zo.isBuffer(r)?r.toString():JSON.stringify(r)}});var Kt=h((ap,Ut)=>{var ea=ee().Buffer,Bt=fr(),ra=mr(),ta=require("stream"),Gt=Er(),gr=require("util");function kt(e,r){return ea.from(e,r).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function na(e,r,t){t=t||"utf8";var n=kt(Gt(e),"binary"),s=kt(Gt(r),t);return gr.format("%s.%s",n,s)}function Ft(e){var r=e.header,t=e.payload,n=e.secret||e.privateKey,s=e.encoding,i=ra(r.alg),o=na(r,t,s),a=i.sign(o,n);return gr.format("%s.%s",o,a)}function Pe(e){var r=e.secret||e.privateKey||e.key,t=new Bt(r);this.readable=!0,this.header=e.header,this.encoding=e.encoding,this.secret=this.privateKey=this.key=t,this.payload=new Bt(e.payload),this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this)),this.payload.once("close",function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}gr.inherits(Pe,ta);Pe.prototype.sign=function(){try{var r=Ft({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",r),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(t){this.readable=!1,this.emit("error",t),this.emit("close")}};Pe.sign=Ft;Ut.exports=Pe});var en=h((cp,Zt)=>{var Ht=ee().Buffer,Mt=fr(),sa=mr(),ia=require("stream"),Xt=Er(),oa=require("util"),aa=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function ca(e){return Object.prototype.toString.call(e)==="[object Object]"}function ua(e){if(ca(e))return e;try{return JSON.parse(e)}catch(r){return}}function Wt(e){var r=e.split(".",1)[0];return ua(Ht.from(r,"base64").toString("binary"))}function fa(e){return e.split(".",2).join(".")}function Yt(e){return e.split(".")[2]}function la(e,r){r=r||"utf8";var t=e.split(".")[1];return Ht.from(t,"base64").toString(r)}function Jt(e){return aa.test(e)&&!!Wt(e)}function zt(e,r,t){if(!r){var n=new Error("Missing algorithm parameter for jws.verify");throw n.code="MISSING_ALGORITHM",n}e=Xt(e);var s=Yt(e),i=fa(e),o=sa(r);return o.verify(i,s,t)}function Qt(e,r){if(r=r||{},e=Xt(e),!Jt(e))return null;var t=Wt(e);if(!t)return null;var n=la(e);return(t.typ==="JWT"||r.json)&&(n=JSON.parse(n,r.encoding)),{header:t,payload:n,signature:Yt(e)}}function ne(e){e=e||{};var r=e.secret||e.publicKey||e.key,t=new Mt(r);this.readable=!0,this.algorithm=e.algorithm,this.encoding=e.encoding,this.secret=this.publicKey=this.key=t,this.signature=new Mt(e.signature),this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this)),this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}oa.inherits(ne,ia);ne.prototype.verify=function(){try{var r=zt(this.signature.buffer,this.algorithm,this.key.buffer),t=Qt(this.signature.buffer,this.encoding);return this.emit("done",r,t),this.emit("data",r),this.emit("end"),this.readable=!1,r}catch(n){this.readable=!1,this.emit("error",n),this.emit("close")}};ne.decode=Qt;ne.isValid=Jt;ne.verify=zt;Zt.exports=ne});var Ve=h(K=>{var rn=Kt(),Ce=en(),ha=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];K.ALGORITHMS=ha;K.sign=rn.sign;K.verify=Ce.verify;K.decode=Ce.decode;K.isValid=Ce.isValid;K.createSign=function(r){return new rn(r)};K.createVerify=function(r){return new Ce(r)}});var yr=h((fp,tn)=>{var pa=Ve();tn.exports=function(e,r){r=r||{};var t=pa.decode(e,r);if(!t)return null;var n=t.payload;if(typeof n=="string")try{var s=JSON.parse(n);s!==null&&typeof s=="object"&&(n=s)}catch(i){}return r.complete===!0?{header:t.header,payload:n,signature:t.signature}:n}});var Ee=h((lp,nn)=>{var Be=function(e,r){Error.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="JsonWebTokenError",this.message=e,r&&(this.inner=r)};Be.prototype=Object.create(Error.prototype);Be.prototype.constructor=Be;nn.exports=Be});var vr=h((hp,on)=>{var sn=Ee(),Ge=function(e,r){sn.call(this,e),this.name="NotBeforeError",this.date=r};Ge.prototype=Object.create(sn.prototype);Ge.prototype.constructor=Ge;on.exports=Ge});var Sr=h((pp,cn)=>{var an=Ee(),ke=function(e,r){an.call(this,e),this.name="TokenExpiredError",this.expiredAt=r};ke.prototype=Object.create(an.prototype);ke.prototype.constructor=ke;cn.exports=ke});var fn=h((dp,un)=>{var se=1e3,ie=se*60,oe=ie*60,H=oe*24,da=H*7,ma=H*365.25;un.exports=function(e,r){r=r||{};var t=typeof e;if(t==="string"&&e.length>0)return Ea(e);if(t==="number"&&isFinite(e))return r.long?ya(e):ga(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Ea(e){if(e=String(e),!(e.length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*ma;case"weeks":case"week":case"w":return t*da;case"days":case"day":case"d":return t*H;case"hours":case"hour":case"hrs":case"hr":case"h":return t*oe;case"minutes":case"minute":case"mins":case"min":case"m":return t*ie;case"seconds":case"second":case"secs":case"sec":case"s":return t*se;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function ga(e){var r=Math.abs(e);return r>=H?Math.round(e/H)+"d":r>=oe?Math.round(e/oe)+"h":r>=ie?Math.round(e/ie)+"m":r>=se?Math.round(e/se)+"s":e+"ms"}function ya(e){var r=Math.abs(e);return r>=H?Fe(e,r,H,"day"):r>=oe?Fe(e,r,oe,"hour"):r>=ie?Fe(e,r,ie,"minute"):r>=se?Fe(e,r,se,"second"):e+" ms"}function Fe(e,r,t,n){var s=r>=t*1.5;return Math.round(e/t)+" "+n+(s?"s":"")}});var wr=h((mp,ln)=>{var va=fn();ln.exports=function(e,r){var t=r||Math.floor(Date.now()/1e3);if(typeof e=="string"){var n=va(e);return typeof n=="undefined"?void 0:Math.floor(t+n/1e3)}else return typeof e=="number"?t+e:void 0}});var ge=h((Ep,hn)=>{var Sa="2.0.0",wa=Number.MAX_SAFE_INTEGER||9007199254740991,ba=16,Ia=256-6,Ta=["major","premajor","minor","preminor","patch","prepatch","prerelease"];hn.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:ba,MAX_SAFE_BUILD_LENGTH:Ia,MAX_SAFE_INTEGER:wa,RELEASE_TYPES:Ta,SEMVER_SPEC_VERSION:Sa,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var ye=h((gp,pn)=>{var Ra=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};pn.exports=Ra});var ae=h((B,dn)=>{var{MAX_SAFE_COMPONENT_LENGTH:br,MAX_SAFE_BUILD_LENGTH:Aa,MAX_LENGTH:xa}=ge(),$a=ye();B=dn.exports={};var Na=B.re=[],La=B.safeRe=[],p=B.src=[],d=B.t={},Oa=0,Ir="[a-zA-Z0-9-]",qa=[["\\s",1],["\\d",xa],[Ir,Aa]],_a=e=>{for(let[r,t]of qa)e=e.split(`${r}*`).join(`${r}{0,${t}}`).split(`${r}+`).join(`${r}{1,${t}}`);return e},E=(e,r,t)=>{let n=_a(r),s=Oa++;$a(e,s,r),d[e]=s,p[s]=r,Na[s]=new RegExp(r,t?"g":void 0),La[s]=new RegExp(n,t?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*");E("NUMERICIDENTIFIERLOOSE","\\d+");E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Ir}*`);E("MAINVERSION",`(${p[d.NUMERICIDENTIFIER]})\\.(${p[d.NUMERICIDENTIFIER]})\\.(${p[d.NUMERICIDENTIFIER]})`);E("MAINVERSIONLOOSE",`(${p[d.NUMERICIDENTIFIERLOOSE]})\\.(${p[d.NUMERICIDENTIFIERLOOSE]})\\.(${p[d.NUMERICIDENTIFIERLOOSE]})`);E("PRERELEASEIDENTIFIER",`(?:${p[d.NUMERICIDENTIFIER]}|${p[d.NONNUMERICIDENTIFIER]})`);E("PRERELEASEIDENTIFIERLOOSE",`(?:${p[d.NUMERICIDENTIFIERLOOSE]}|${p[d.NONNUMERICIDENTIFIER]})`);E("PRERELEASE",`(?:-(${p[d.PRERELEASEIDENTIFIER]}(?:\\.${p[d.PRERELEASEIDENTIFIER]})*))`);E("PRERELEASELOOSE",`(?:-?(${p[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${p[d.PRERELEASEIDENTIFIERLOOSE]})*))`);E("BUILDIDENTIFIER",`${Ir}+`);E("BUILD",`(?:\\+(${p[d.BUILDIDENTIFIER]}(?:\\.${p[d.BUILDIDENTIFIER]})*))`);E("FULLPLAIN",`v?${p[d.MAINVERSION]}${p[d.PRERELEASE]}?${p[d.BUILD]}?`);E("FULL",`^${p[d.FULLPLAIN]}$`);E("LOOSEPLAIN",`[v=\\s]*${p[d.MAINVERSIONLOOSE]}${p[d.PRERELEASELOOSE]}?${p[d.BUILD]}?`);E("LOOSE",`^${p[d.LOOSEPLAIN]}$`);E("GTLT","((?:<|>)?=?)");E("XRANGEIDENTIFIERLOOSE",`${p[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);E("XRANGEIDENTIFIER",`${p[d.NUMERICIDENTIFIER]}|x|X|\\*`);E("XRANGEPLAIN",`[v=\\s]*(${p[d.XRANGEIDENTIFIER]})(?:\\.(${p[d.XRANGEIDENTIFIER]})(?:\\.(${p[d.XRANGEIDENTIFIER]})(?:${p[d.PRERELEASE]})?${p[d.BUILD]}?)?)?`);E("XRANGEPLAINLOOSE",`[v=\\s]*(${p[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${p[d.XRANGEIDENTIFIERLOOSE]})(?:${p[d.PRERELEASELOOSE]})?${p[d.BUILD]}?)?)?`);E("XRANGE",`^${p[d.GTLT]}\\s*${p[d.XRANGEPLAIN]}$`);E("XRANGELOOSE",`^${p[d.GTLT]}\\s*${p[d.XRANGEPLAINLOOSE]}$`);E("COERCE",`(^|[^\\d])(\\d{1,${br}})(?:\\.(\\d{1,${br}}))?(?:\\.(\\d{1,${br}}))?(?:$|[^\\d])`);E("COERCERTL",p[d.COERCE],!0);E("LONETILDE","(?:~>?)");E("TILDETRIM",`(\\s*)${p[d.LONETILDE]}\\s+`,!0);B.tildeTrimReplace="$1~";E("TILDE",`^${p[d.LONETILDE]}${p[d.XRANGEPLAIN]}$`);E("TILDELOOSE",`^${p[d.LONETILDE]}${p[d.XRANGEPLAINLOOSE]}$`);E("LONECARET","(?:\\^)");E("CARETTRIM",`(\\s*)${p[d.LONECARET]}\\s+`,!0);B.caretTrimReplace="$1^";E("CARET",`^${p[d.LONECARET]}${p[d.XRANGEPLAIN]}$`);E("CARETLOOSE",`^${p[d.LONECARET]}${p[d.XRANGEPLAINLOOSE]}$`);E("COMPARATORLOOSE",`^${p[d.GTLT]}\\s*(${p[d.LOOSEPLAIN]})$|^$`);E("COMPARATOR",`^${p[d.GTLT]}\\s*(${p[d.FULLPLAIN]})$|^$`);E("COMPARATORTRIM",`(\\s*)${p[d.GTLT]}\\s*(${p[d.LOOSEPLAIN]}|${p[d.XRANGEPLAIN]})`,!0);B.comparatorTrimReplace="$1$2$3";E("HYPHENRANGE",`^\\s*(${p[d.XRANGEPLAIN]})\\s+-\\s+(${p[d.XRANGEPLAIN]})\\s*$`);E("HYPHENRANGELOOSE",`^\\s*(${p[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${p[d.XRANGEPLAINLOOSE]})\\s*$`);E("STAR","(<|>)?=?\\s*\\*");E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Ue=h((yp,mn)=>{var ja=Object.freeze({loose:!0}),Da=Object.freeze({}),Pa=e=>e?typeof e!="object"?ja:e:Da;mn.exports=Pa});var Tr=h((vp,yn)=>{var En=/^[0-9]+$/,gn=(e,r)=>{let t=En.test(e),n=En.test(r);return t&&n&&(e=+e,r=+r),e===r?0:t&&!n?-1:n&&!t?1:e<r?-1:1},Ca=(e,r)=>gn(r,e);yn.exports={compareIdentifiers:gn,rcompareIdentifiers:Ca}});var A=h((Sp,bn)=>{var Ke=ye(),{MAX_LENGTH:vn,MAX_SAFE_INTEGER:Me}=ge(),{safeRe:Sn,t:wn}=ae(),Va=Ue(),{compareIdentifiers:ce}=Tr(),Rr=class e{constructor(r,t){if(t=Va(t),r instanceof e){if(r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>vn)throw new TypeError(`version is longer than ${vn} characters`);Ke("SemVer",r,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=r.trim().match(t.loose?Sn[wn.LOOSE]:Sn[wn.FULL]);if(!n)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Me||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Me||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Me||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){let i=+s;if(i>=0&&i<Me)return i}return s}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(Ke("SemVer.compare",this.version,this.options,r),!(r instanceof e)){if(typeof r=="string"&&r===this.version)return 0;r=new e(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof e||(r=new e(r,this.options)),ce(this.major,r.major)||ce(this.minor,r.minor)||ce(this.patch,r.patch)}comparePre(r){if(r instanceof e||(r=new e(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],s=r.prerelease[t];if(Ke("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return ce(n,s)}while(++t)}compareBuild(r){r instanceof e||(r=new e(r,this.options));let t=0;do{let n=this.build[t],s=r.build[t];if(Ke("prerelease compare",t,n,s),n===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(n===void 0)return-1;if(n===s)continue;return ce(n,s)}while(++t)}inc(r,t,n){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let s=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(t){let i=[t,s];n===!1&&(i=[t]),ce(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};bn.exports=Rr});var X=h((wp,Tn)=>{var In=A(),Ba=(e,r,t=!1)=>{if(e instanceof In)return e;try{return new In(e,r)}catch(n){if(!t)return null;throw n}};Tn.exports=Ba});var An=h((bp,Rn)=>{var Ga=X(),ka=(e,r)=>{let t=Ga(e,r);return t?t.version:null};Rn.exports=ka});var $n=h((Ip,xn)=>{var Fa=X(),Ua=(e,r)=>{let t=Fa(e.trim().replace(/^[=v]+/,""),r);return t?t.version:null};xn.exports=Ua});var On=h((Tp,Ln)=>{var Nn=A(),Ka=(e,r,t,n,s)=>{typeof t=="string"&&(s=n,n=t,t=void 0);try{return new Nn(e instanceof Nn?e.version:e,t).inc(r,n,s).version}catch(i){return null}};Ln.exports=Ka});var jn=h((Rp,_n)=>{var qn=X(),Ma=(e,r)=>{let t=qn(e,null,!0),n=qn(r,null,!0),s=t.compare(n);if(s===0)return null;let i=s>0,o=i?t:n,a=i?n:t,c=!!o.prerelease.length;if(!!a.prerelease.length&&!c)return!a.patch&&!a.minor?"major":o.patch?"patch":o.minor?"minor":"major";let l=c?"pre":"";return t.major!==n.major?l+"major":t.minor!==n.minor?l+"minor":t.patch!==n.patch?l+"patch":"prerelease"};_n.exports=Ma});var Pn=h((Ap,Dn)=>{var Ha=A(),Xa=(e,r)=>new Ha(e,r).major;Dn.exports=Xa});var Vn=h((xp,Cn)=>{var Wa=A(),Ya=(e,r)=>new Wa(e,r).minor;Cn.exports=Ya});var Gn=h(($p,Bn)=>{var Ja=A(),za=(e,r)=>new Ja(e,r).patch;Bn.exports=za});var Fn=h((Np,kn)=>{var Qa=X(),Za=(e,r)=>{let t=Qa(e,r);return t&&t.prerelease.length?t.prerelease:null};kn.exports=Za});var q=h((Lp,Kn)=>{var Un=A(),ec=(e,r,t)=>new Un(e,t).compare(new Un(r,t));Kn.exports=ec});var Hn=h((Op,Mn)=>{var rc=q(),tc=(e,r,t)=>rc(r,e,t);Mn.exports=tc});var Wn=h((qp,Xn)=>{var nc=q(),sc=(e,r)=>nc(e,r,!0);Xn.exports=sc});var He=h((_p,Jn)=>{var Yn=A(),ic=(e,r,t)=>{let n=new Yn(e,t),s=new Yn(r,t);return n.compare(s)||n.compareBuild(s)};Jn.exports=ic});var Qn=h((jp,zn)=>{var oc=He(),ac=(e,r)=>e.sort((t,n)=>oc(t,n,r));zn.exports=ac});var es=h((Dp,Zn)=>{var cc=He(),uc=(e,r)=>e.sort((t,n)=>cc(n,t,r));Zn.exports=uc});var ve=h((Pp,rs)=>{var fc=q(),lc=(e,r,t)=>fc(e,r,t)>0;rs.exports=lc});var Xe=h((Cp,ts)=>{var hc=q(),pc=(e,r,t)=>hc(e,r,t)<0;ts.exports=pc});var Ar=h((Vp,ns)=>{var dc=q(),mc=(e,r,t)=>dc(e,r,t)===0;ns.exports=mc});var xr=h((Bp,ss)=>{var Ec=q(),gc=(e,r,t)=>Ec(e,r,t)!==0;ss.exports=gc});var We=h((Gp,is)=>{var yc=q(),vc=(e,r,t)=>yc(e,r,t)>=0;is.exports=vc});var Ye=h((kp,os)=>{var Sc=q(),wc=(e,r,t)=>Sc(e,r,t)<=0;os.exports=wc});var $r=h((Fp,as)=>{var bc=Ar(),Ic=xr(),Tc=ve(),Rc=We(),Ac=Xe(),xc=Ye(),$c=(e,r,t,n)=>{switch(r){case"===":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e===t;case"!==":return typeof e=="object"&&(e=e.version),typeof t=="object"&&(t=t.version),e!==t;case"":case"=":case"==":return bc(e,t,n);case"!=":return Ic(e,t,n);case">":return Tc(e,t,n);case">=":return Rc(e,t,n);case"<":return Ac(e,t,n);case"<=":return xc(e,t,n);default:throw new TypeError(`Invalid operator: ${r}`)}};as.exports=$c});var us=h((Up,cs)=>{var Nc=A(),Lc=X(),{safeRe:Je,t:ze}=ae(),Oc=(e,r)=>{if(e instanceof Nc)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;r=r||{};let t=null;if(!r.rtl)t=e.match(Je[ze.COERCE]);else{let n;for(;(n=Je[ze.COERCERTL].exec(e))&&(!t||t.index+t[0].length!==e.length);)(!t||n.index+n[0].length!==t.index+t[0].length)&&(t=n),Je[ze.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;Je[ze.COERCERTL].lastIndex=-1}return t===null?null:Lc(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,r)};cs.exports=Oc});var ls=h((Kp,fs)=>{"use strict";fs.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let r=this.head;r;r=r.next)yield r.value}}});var ps=h((Mp,hs)=>{"use strict";hs.exports=y;y.Node=W;y.create=y;function y(e){var r=this;if(r instanceof y||(r=new y),r.tail=null,r.head=null,r.length=0,e&&typeof e.forEach=="function")e.forEach(function(s){r.push(s)});else if(arguments.length>0)for(var t=0,n=arguments.length;t<n;t++)r.push(arguments[t]);return r}y.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var r=e.next,t=e.prev;return r&&(r.prev=t),t&&(t.next=r),e===this.head&&(this.head=r),e===this.tail&&(this.tail=t),e.list.length--,e.next=null,e.prev=null,e.list=null,r};y.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var r=this.head;e.list=this,e.next=r,r&&(r.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};y.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var r=this.tail;e.list=this,e.prev=r,r&&(r.next=e),this.tail=e,this.head||(this.head=e),this.length++}};y.prototype.push=function(){for(var e=0,r=arguments.length;e<r;e++)_c(this,arguments[e]);return this.length};y.prototype.unshift=function(){for(var e=0,r=arguments.length;e<r;e++)jc(this,arguments[e]);return this.length};y.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};y.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};y.prototype.forEach=function(e,r){r=r||this;for(var t=this.head,n=0;t!==null;n++)e.call(r,t.value,n,this),t=t.next};y.prototype.forEachReverse=function(e,r){r=r||this;for(var t=this.tail,n=this.length-1;t!==null;n--)e.call(r,t.value,n,this),t=t.prev};y.prototype.get=function(e){for(var r=0,t=this.head;t!==null&&r<e;r++)t=t.next;if(r===e&&t!==null)return t.value};y.prototype.getReverse=function(e){for(var r=0,t=this.tail;t!==null&&r<e;r++)t=t.prev;if(r===e&&t!==null)return t.value};y.prototype.map=function(e,r){r=r||this;for(var t=new y,n=this.head;n!==null;)t.push(e.call(r,n.value,this)),n=n.next;return t};y.prototype.mapReverse=function(e,r){r=r||this;for(var t=new y,n=this.tail;n!==null;)t.push(e.call(r,n.value,this)),n=n.prev;return t};y.prototype.reduce=function(e,r){var t,n=this.head;if(arguments.length>1)t=r;else if(this.head)n=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=0;n!==null;s++)t=e(t,n.value,s),n=n.next;return t};y.prototype.reduceReverse=function(e,r){var t,n=this.tail;if(arguments.length>1)t=r;else if(this.tail)n=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var s=this.length-1;n!==null;s--)t=e(t,n.value,s),n=n.prev;return t};y.prototype.toArray=function(){for(var e=new Array(this.length),r=0,t=this.head;t!==null;r++)e[r]=t.value,t=t.next;return e};y.prototype.toArrayReverse=function(){for(var e=new Array(this.length),r=0,t=this.tail;t!==null;r++)e[r]=t.value,t=t.prev;return e};y.prototype.slice=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new y;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=0,s=this.head;s!==null&&n<e;n++)s=s.next;for(;s!==null&&n<r;n++,s=s.next)t.push(s.value);return t};y.prototype.sliceReverse=function(e,r){r=r||this.length,r<0&&(r+=this.length),e=e||0,e<0&&(e+=this.length);var t=new y;if(r<e||r<0)return t;e<0&&(e=0),r>this.length&&(r=this.length);for(var n=this.length,s=this.tail;s!==null&&n>r;n--)s=s.prev;for(;s!==null&&n>e;n--,s=s.prev)t.push(s.value);return t};y.prototype.splice=function(e,r,...t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;s!==null&&n<e;n++)s=s.next;for(var i=[],n=0;s&&n<r;n++)i.push(s.value),s=this.removeNode(s);s===null&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev);for(var n=0;n<t.length;n++)s=qc(this,s,t[n]);return i};y.prototype.reverse=function(){for(var e=this.head,r=this.tail,t=e;t!==null;t=t.prev){var n=t.prev;t.prev=t.next,t.next=n}return this.head=r,this.tail=e,this};function qc(e,r,t){var n=r===e.head?new W(t,null,r,e):new W(t,r,r.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function _c(e,r){e.tail=new W(r,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function jc(e,r){e.head=new W(r,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function W(e,r,t,n){if(!(this instanceof W))return new W(e,r,t,n);this.list=n,this.value=e,r?(r.next=this,this.prev=r):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{ls()(y)}catch(e){}});var ys=h((Hp,gs)=>{"use strict";var Dc=ps(),Y=Symbol("max"),k=Symbol("length"),ue=Symbol("lengthCalculator"),we=Symbol("allowStale"),J=Symbol("maxAge"),G=Symbol("dispose"),ds=Symbol("noDisposeOnSet"),R=Symbol("lruList"),D=Symbol("cache"),Es=Symbol("updateAgeOnGet"),Nr=()=>1,Or=class{constructor(r){if(typeof r=="number"&&(r={max:r}),r||(r={}),r.max&&(typeof r.max!="number"||r.max<0))throw new TypeError("max must be a non-negative number");let t=this[Y]=r.max||1/0,n=r.length||Nr;if(this[ue]=typeof n!="function"?Nr:n,this[we]=r.stale||!1,r.maxAge&&typeof r.maxAge!="number")throw new TypeError("maxAge must be a number");this[J]=r.maxAge||0,this[G]=r.dispose,this[ds]=r.noDisposeOnSet||!1,this[Es]=r.updateAgeOnGet||!1,this.reset()}set max(r){if(typeof r!="number"||r<0)throw new TypeError("max must be a non-negative number");this[Y]=r||1/0,Se(this)}get max(){return this[Y]}set allowStale(r){this[we]=!!r}get allowStale(){return this[we]}set maxAge(r){if(typeof r!="number")throw new TypeError("maxAge must be a non-negative number");this[J]=r,Se(this)}get maxAge(){return this[J]}set lengthCalculator(r){typeof r!="function"&&(r=Nr),r!==this[ue]&&(this[ue]=r,this[k]=0,this[R].forEach(t=>{t.length=this[ue](t.value,t.key),this[k]+=t.length})),Se(this)}get lengthCalculator(){return this[ue]}get length(){return this[k]}get itemCount(){return this[R].length}rforEach(r,t){t=t||this;for(let n=this[R].tail;n!==null;){let s=n.prev;ms(this,r,n,t),n=s}}forEach(r,t){t=t||this;for(let n=this[R].head;n!==null;){let s=n.next;ms(this,r,n,t),n=s}}keys(){return this[R].toArray().map(r=>r.key)}values(){return this[R].toArray().map(r=>r.value)}reset(){this[G]&&this[R]&&this[R].length&&this[R].forEach(r=>this[G](r.key,r.value)),this[D]=new Map,this[R]=new Dc,this[k]=0}dump(){return this[R].map(r=>Qe(this,r)?!1:{k:r.key,v:r.value,e:r.now+(r.maxAge||0)}).toArray().filter(r=>r)}dumpLru(){return this[R]}set(r,t,n){if(n=n||this[J],n&&typeof n!="number")throw new TypeError("maxAge must be a number");let s=n?Date.now():0,i=this[ue](t,r);if(this[D].has(r)){if(i>this[Y])return fe(this,this[D].get(r)),!1;let c=this[D].get(r).value;return this[G]&&(this[ds]||this[G](r,c.value)),c.now=s,c.maxAge=n,c.value=t,this[k]+=i-c.length,c.length=i,this.get(r),Se(this),!0}let o=new qr(r,t,i,s,n);return o.length>this[Y]?(this[G]&&this[G](r,t),!1):(this[k]+=o.length,this[R].unshift(o),this[D].set(r,this[R].head),Se(this),!0)}has(r){if(!this[D].has(r))return!1;let t=this[D].get(r).value;return!Qe(this,t)}get(r){return Lr(this,r,!0)}peek(r){return Lr(this,r,!1)}pop(){let r=this[R].tail;return r?(fe(this,r),r.value):null}del(r){fe(this,this[D].get(r))}load(r){this.reset();let t=Date.now();for(let n=r.length-1;n>=0;n--){let s=r[n],i=s.e||0;if(i===0)this.set(s.k,s.v);else{let o=i-t;o>0&&this.set(s.k,s.v,o)}}}prune(){this[D].forEach((r,t)=>Lr(this,t,!1))}},Lr=(e,r,t)=>{let n=e[D].get(r);if(n){let s=n.value;if(Qe(e,s)){if(fe(e,n),!e[we])return}else t&&(e[Es]&&(n.value.now=Date.now()),e[R].unshiftNode(n));return s.value}},Qe=(e,r)=>{if(!r||!r.maxAge&&!e[J])return!1;let t=Date.now()-r.now;return r.maxAge?t>r.maxAge:e[J]&&t>e[J]},Se=e=>{if(e[k]>e[Y])for(let r=e[R].tail;e[k]>e[Y]&&r!==null;){let t=r.prev;fe(e,r),r=t}},fe=(e,r)=>{if(r){let t=r.value;e[G]&&e[G](t.key,t.value),e[k]-=t.length,e[D].delete(t.key),e[R].removeNode(r)}},qr=class{constructor(r,t,n,s,i){this.key=r,this.value=t,this.length=n,this.now=s,this.maxAge=i||0}},ms=(e,r,t,n)=>{let s=t.value;Qe(e,s)&&(fe(e,t),e[we]||(s=void 0)),s&&r.call(n,s.value,s.key,e)};gs.exports=Or});var _=h((Xp,bs)=>{var _r=class e{constructor(r,t){if(t=Cc(t),r instanceof e)return r.loose===!!t.loose&&r.includePrerelease===!!t.includePrerelease?r:new e(r.raw,t);if(r instanceof jr)return this.raw=r.value,this.set=[[r]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(s=>!Ss(s[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let s of this.set)if(s.length===1&&Kc(s[0])){this.set=[s];break}}}this.format()}format(){return this.range=this.set.map(r=>r.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(r){let n=((this.options.includePrerelease&&Fc)|(this.options.loose&&Uc))+":"+r,s=vs.get(n);if(s)return s;let i=this.options.loose,o=i?O[x.HYPHENRANGELOOSE]:O[x.HYPHENRANGE];r=r.replace(o,eu(this.options.includePrerelease)),w("hyphen replace",r),r=r.replace(O[x.COMPARATORTRIM],Bc),w("comparator trim",r),r=r.replace(O[x.TILDETRIM],Gc),w("tilde trim",r),r=r.replace(O[x.CARETTRIM],kc),w("caret trim",r);let a=r.split(" ").map(f=>Mc(f,this.options)).join(" ").split(/\s+/).map(f=>Zc(f,this.options));i&&(a=a.filter(f=>(w("loose invalid filter",f,this.options),!!f.match(O[x.COMPARATORLOOSE])))),w("range list",a);let c=new Map,u=a.map(f=>new jr(f,this.options));for(let f of u){if(Ss(f))return[f];c.set(f.value,f)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return vs.set(n,l),l}intersects(r,t){if(!(r instanceof e))throw new TypeError("a Range is required");return this.set.some(n=>ws(n,t)&&r.set.some(s=>ws(s,t)&&n.every(i=>s.every(o=>i.intersects(o,t)))))}test(r){if(!r)return!1;if(typeof r=="string")try{r=new Vc(r,this.options)}catch(t){return!1}for(let t=0;t<this.set.length;t++)if(ru(this.set[t],r,this.options))return!0;return!1}};bs.exports=_r;var Pc=ys(),vs=new Pc({max:1e3}),Cc=Ue(),jr=be(),w=ye(),Vc=A(),{safeRe:O,t:x,comparatorTrimReplace:Bc,tildeTrimReplace:Gc,caretTrimReplace:kc}=ae(),{FLAG_INCLUDE_PRERELEASE:Fc,FLAG_LOOSE:Uc}=ge(),Ss=e=>e.value==="<0.0.0-0",Kc=e=>e.value==="",ws=(e,r)=>{let t=!0,n=e.slice(),s=n.pop();for(;t&&n.length;)t=n.every(i=>s.intersects(i,r)),s=n.pop();return t},Mc=(e,r)=>(w("comp",e,r),e=Wc(e,r),w("caret",e),e=Hc(e,r),w("tildes",e),e=Jc(e,r),w("xrange",e),e=Qc(e,r),w("stars",e),e),$=e=>!e||e.toLowerCase()==="x"||e==="*",Hc=(e,r)=>e.trim().split(/\s+/).map(t=>Xc(t,r)).join(" "),Xc=(e,r)=>{let t=r.loose?O[x.TILDELOOSE]:O[x.TILDE];return e.replace(t,(n,s,i,o,a)=>{w("tilde",e,n,s,i,o,a);let c;return $(s)?c="":$(i)?c=`>=${s}.0.0 <${+s+1}.0.0-0`:$(o)?c=`>=${s}.${i}.0 <${s}.${+i+1}.0-0`:a?(w("replaceTilde pr",a),c=`>=${s}.${i}.${o}-${a} <${s}.${+i+1}.0-0`):c=`>=${s}.${i}.${o} <${s}.${+i+1}.0-0`,w("tilde return",c),c})},Wc=(e,r)=>e.trim().split(/\s+/).map(t=>Yc(t,r)).join(" "),Yc=(e,r)=>{w("caret",e,r);let t=r.loose?O[x.CARETLOOSE]:O[x.CARET],n=r.includePrerelease?"-0":"";return e.replace(t,(s,i,o,a,c)=>{w("caret",e,s,i,o,a,c);let u;return $(i)?u="":$(o)?u=`>=${i}.0.0${n} <${+i+1}.0.0-0`:$(a)?i==="0"?u=`>=${i}.${o}.0${n} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.0${n} <${+i+1}.0.0-0`:c?(w("replaceCaret pr",c),i==="0"?o==="0"?u=`>=${i}.${o}.${a}-${c} <${i}.${o}.${+a+1}-0`:u=`>=${i}.${o}.${a}-${c} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${a}-${c} <${+i+1}.0.0-0`):(w("no pr"),i==="0"?o==="0"?u=`>=${i}.${o}.${a}${n} <${i}.${o}.${+a+1}-0`:u=`>=${i}.${o}.${a}${n} <${i}.${+o+1}.0-0`:u=`>=${i}.${o}.${a} <${+i+1}.0.0-0`),w("caret return",u),u})},Jc=(e,r)=>(w("replaceXRanges",e,r),e.split(/\s+/).map(t=>zc(t,r)).join(" ")),zc=(e,r)=>{e=e.trim();let t=r.loose?O[x.XRANGELOOSE]:O[x.XRANGE];return e.replace(t,(n,s,i,o,a,c)=>{w("xRange",e,n,s,i,o,a,c);let u=$(i),l=u||$(o),f=l||$(a),g=f;return s==="="&&g&&(s=""),c=r.includePrerelease?"-0":"",u?s===">"||s==="<"?n="<0.0.0-0":n="*":s&&g?(l&&(o=0),a=0,s===">"?(s=">=",l?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):s==="<="&&(s="<",l?i=+i+1:o=+o+1),s==="<"&&(c="-0"),n=`${s+i}.${o}.${a}${c}`):l?n=`>=${i}.0.0${c} <${+i+1}.0.0-0`:f&&(n=`>=${i}.${o}.0${c} <${i}.${+o+1}.0-0`),w("xRange return",n),n})},Qc=(e,r)=>(w("replaceStars",e,r),e.trim().replace(O[x.STAR],"")),Zc=(e,r)=>(w("replaceGTE0",e,r),e.trim().replace(O[r.includePrerelease?x.GTE0PRE:x.GTE0],"")),eu=e=>(r,t,n,s,i,o,a,c,u,l,f,g,m)=>($(n)?t="":$(s)?t=`>=${n}.0.0${e?"-0":""}`:$(i)?t=`>=${n}.${s}.0${e?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${e?"-0":""}`,$(u)?c="":$(l)?c=`<${+u+1}.0.0-0`:$(f)?c=`<${u}.${+l+1}.0-0`:g?c=`<=${u}.${l}.${f}-${g}`:e?c=`<${u}.${l}.${+f+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),ru=(e,r,t)=>{for(let n=0;n<e.length;n++)if(!e[n].test(r))return!1;if(r.prerelease.length&&!t.includePrerelease){for(let n=0;n<e.length;n++)if(w(e[n].semver),e[n].semver!==jr.ANY&&e[n].semver.prerelease.length>0){let s=e[n].semver;if(s.major===r.major&&s.minor===r.minor&&s.patch===r.patch)return!0}return!1}return!0}});var be=h((Wp,$s)=>{var Ie=Symbol("SemVer ANY"),Cr=class e{static get ANY(){return Ie}constructor(r,t){if(t=Is(t),r instanceof e){if(r.loose===!!t.loose)return r;r=r.value}r=r.trim().split(/\s+/).join(" "),Pr("comparator",r,t),this.options=t,this.loose=!!t.loose,this.parse(r),this.semver===Ie?this.value="":this.value=this.operator+this.semver.version,Pr("comp",this)}parse(r){let t=this.options.loose?Ts[Rs.COMPARATORLOOSE]:Ts[Rs.COMPARATOR],n=r.match(t);if(!n)throw new TypeError(`Invalid comparator: ${r}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new As(n[2],this.options.loose):this.semver=Ie}toString(){return this.value}test(r){if(Pr("Comparator.test",r,this.options.loose),this.semver===Ie||r===Ie)return!0;if(typeof r=="string")try{r=new As(r,this.options)}catch(t){return!1}return Dr(r,this.operator,this.semver,this.options)}intersects(r,t){if(!(r instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new xs(r.value,t).test(this.value):r.operator===""?r.value===""?!0:new xs(this.value,t).test(r.semver):(t=Is(t),t.includePrerelease&&(this.value==="<0.0.0-0"||r.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||r.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&r.operator.startsWith(">")||this.operator.startsWith("<")&&r.operator.startsWith("<")||this.semver.version===r.semver.version&&this.operator.includes("=")&&r.operator.includes("=")||Dr(this.semver,"<",r.semver,t)&&this.operator.startsWith(">")&&r.operator.startsWith("<")||Dr(this.semver,">",r.semver,t)&&this.operator.startsWith("<")&&r.operator.startsWith(">")))}};$s.exports=Cr;var Is=Ue(),{safeRe:Ts,t:Rs}=ae(),Dr=$r(),Pr=ye(),As=A(),xs=_()});var Te=h((Yp,Ns)=>{var tu=_(),nu=(e,r,t)=>{try{r=new tu(r,t)}catch(n){return!1}return r.test(e)};Ns.exports=nu});var Os=h((Jp,Ls)=>{var su=_(),iu=(e,r)=>new su(e,r).set.map(t=>t.map(n=>n.value).join(" ").trim().split(" "));Ls.exports=iu});var _s=h((zp,qs)=>{var ou=A(),au=_(),cu=(e,r,t)=>{let n=null,s=null,i=null;try{i=new au(r,t)}catch(o){return null}return e.forEach(o=>{i.test(o)&&(!n||s.compare(o)===-1)&&(n=o,s=new ou(n,t))}),n};qs.exports=cu});var Ds=h((Qp,js)=>{var uu=A(),fu=_(),lu=(e,r,t)=>{let n=null,s=null,i=null;try{i=new fu(r,t)}catch(o){return null}return e.forEach(o=>{i.test(o)&&(!n||s.compare(o)===1)&&(n=o,s=new uu(n,t))}),n};js.exports=lu});var Vs=h((Zp,Cs)=>{var Vr=A(),hu=_(),Ps=ve(),pu=(e,r)=>{e=new hu(e,r);let t=new Vr("0.0.0");if(e.test(t)||(t=new Vr("0.0.0-0"),e.test(t)))return t;t=null;for(let n=0;n<e.set.length;++n){let s=e.set[n],i=null;s.forEach(o=>{let a=new Vr(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!i||Ps(a,i))&&(i=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${o.operator}`)}}),i&&(!t||Ps(t,i))&&(t=i)}return t&&e.test(t)?t:null};Cs.exports=pu});var Gs=h((ed,Bs)=>{var du=_(),mu=(e,r)=>{try{return new du(e,r).range||"*"}catch(t){return null}};Bs.exports=mu});var Ze=h((rd,Ks)=>{var Eu=A(),Us=be(),{ANY:gu}=Us,yu=_(),vu=Te(),ks=ve(),Fs=Xe(),Su=Ye(),wu=We(),bu=(e,r,t,n)=>{e=new Eu(e,n),r=new yu(r,n);let s,i,o,a,c;switch(t){case">":s=ks,i=Su,o=Fs,a=">",c=">=";break;case"<":s=Fs,i=wu,o=ks,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(vu(e,r,n))return!1;for(let u=0;u<r.set.length;++u){let l=r.set[u],f=null,g=null;if(l.forEach(m=>{m.semver===gu&&(m=new Us(">=0.0.0")),f=f||m,g=g||m,s(m.semver,f.semver,n)?f=m:o(m.semver,g.semver,n)&&(g=m)}),f.operator===a||f.operator===c||(!g.operator||g.operator===a)&&i(e,g.semver))return!1;if(g.operator===c&&o(e,g.semver))return!1}return!0};Ks.exports=bu});var Hs=h((td,Ms)=>{var Iu=Ze(),Tu=(e,r,t)=>Iu(e,r,">",t);Ms.exports=Tu});var Ws=h((nd,Xs)=>{var Ru=Ze(),Au=(e,r,t)=>Ru(e,r,"<",t);Xs.exports=Au});var zs=h((sd,Js)=>{var Ys=_(),xu=(e,r,t)=>(e=new Ys(e,t),r=new Ys(r,t),e.intersects(r,t));Js.exports=xu});var Zs=h((id,Qs)=>{var $u=Te(),Nu=q();Qs.exports=(e,r,t)=>{let n=[],s=null,i=null,o=e.sort((l,f)=>Nu(l,f,t));for(let l of o)$u(l,r,t)?(i=l,s||(s=l)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);let a=[];for(let[l,f]of n)l===f?a.push(l):!f&&l===o[0]?a.push("*"):f?l===o[0]?a.push(`<=${f}`):a.push(`${l} - ${f}`):a.push(`>=${l}`);let c=a.join(" || "),u=typeof r.raw=="string"?r.raw:String(r);return c.length<u.length?c:r}});var ii=h((od,si)=>{var ei=_(),Gr=be(),{ANY:Br}=Gr,Re=Te(),kr=q(),Lu=(e,r,t={})=>{if(e===r)return!0;e=new ei(e,t),r=new ei(r,t);let n=!1;e:for(let s of e.set){for(let i of r.set){let o=qu(s,i,t);if(n=n||o!==null,o)continue e}if(n)return!1}return!0},Ou=[new Gr(">=0.0.0-0")],ri=[new Gr(">=0.0.0")],qu=(e,r,t)=>{if(e===r)return!0;if(e.length===1&&e[0].semver===Br){if(r.length===1&&r[0].semver===Br)return!0;t.includePrerelease?e=Ou:e=ri}if(r.length===1&&r[0].semver===Br){if(t.includePrerelease)return!0;r=ri}let n=new Set,s,i;for(let m of e)m.operator===">"||m.operator===">="?s=ti(s,m,t):m.operator==="<"||m.operator==="<="?i=ni(i,m,t):n.add(m.semver);if(n.size>1)return null;let o;if(s&&i){if(o=kr(s.semver,i.semver,t),o>0)return null;if(o===0&&(s.operator!==">="||i.operator!=="<="))return null}for(let m of n){if(s&&!Re(m,String(s),t)||i&&!Re(m,String(i),t))return null;for(let b of r)if(!Re(m,String(b),t))return!1;return!0}let a,c,u,l,f=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1,g=s&&!t.includePrerelease&&s.semver.prerelease.length?s.semver:!1;f&&f.prerelease.length===1&&i.operator==="<"&&f.prerelease[0]===0&&(f=!1);for(let m of r){if(l=l||m.operator===">"||m.operator===">=",u=u||m.operator==="<"||m.operator==="<=",s){if(g&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===g.major&&m.semver.minor===g.minor&&m.semver.patch===g.patch&&(g=!1),m.operator===">"||m.operator===">="){if(a=ti(s,m,t),a===m&&a!==s)return!1}else if(s.operator===">="&&!Re(s.semver,String(m),t))return!1}if(i){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator==="<"||m.operator==="<="){if(c=ni(i,m,t),c===m&&c!==i)return!1}else if(i.operator==="<="&&!Re(i.semver,String(m),t))return!1}if(!m.operator&&(i||s)&&o!==0)return!1}return!(s&&u&&!i&&o!==0||i&&l&&!s&&o!==0||g||f)},ti=(e,r,t)=>{if(!e)return r;let n=kr(e.semver,r.semver,t);return n>0?e:n<0||r.operator===">"&&e.operator===">="?r:e},ni=(e,r,t)=>{if(!e)return r;let n=kr(e.semver,r.semver,t);return n<0?e:n>0||r.operator==="<"&&e.operator==="<="?r:e};si.exports=Lu});var er=h((ad,ci)=>{var Fr=ae(),oi=ge(),_u=A(),ai=Tr(),ju=X(),Du=An(),Pu=$n(),Cu=On(),Vu=jn(),Bu=Pn(),Gu=Vn(),ku=Gn(),Fu=Fn(),Uu=q(),Ku=Hn(),Mu=Wn(),Hu=He(),Xu=Qn(),Wu=es(),Yu=ve(),Ju=Xe(),zu=Ar(),Qu=xr(),Zu=We(),ef=Ye(),rf=$r(),tf=us(),nf=be(),sf=_(),of=Te(),af=Os(),cf=_s(),uf=Ds(),ff=Vs(),lf=Gs(),hf=Ze(),pf=Hs(),df=Ws(),mf=zs(),Ef=Zs(),gf=ii();ci.exports={parse:ju,valid:Du,clean:Pu,inc:Cu,diff:Vu,major:Bu,minor:Gu,patch:ku,prerelease:Fu,compare:Uu,rcompare:Ku,compareLoose:Mu,compareBuild:Hu,sort:Xu,rsort:Wu,gt:Yu,lt:Ju,eq:zu,neq:Qu,gte:Zu,lte:ef,cmp:rf,coerce:tf,Comparator:nf,Range:sf,satisfies:of,toComparators:af,maxSatisfying:cf,minSatisfying:uf,minVersion:ff,validRange:lf,outside:hf,gtr:pf,ltr:df,intersects:mf,simplifyRange:Ef,subset:gf,SemVer:_u,re:Fr.re,src:Fr.src,tokens:Fr.t,SEMVER_SPEC_VERSION:oi.SEMVER_SPEC_VERSION,RELEASE_TYPES:oi.RELEASE_TYPES,compareIdentifiers:ai.compareIdentifiers,rcompareIdentifiers:ai.rcompareIdentifiers}});var fi=h((cd,ui)=>{var yf=er();ui.exports=yf.satisfies(process.version,">=15.7.0")});var hi=h((ud,li)=>{var vf=er();li.exports=vf.satisfies(process.version,">=16.9.0")});var Ur=h((fd,pi)=>{var Sf=fi(),wf=hi(),bf={ec:["ES256","ES384","ES512"],rsa:["RS256","PS256","RS384","PS384","RS512","PS512"],"rsa-pss":["PS256","PS384","PS512"]},If={ES256:"prime256v1",ES384:"secp384r1",ES512:"secp521r1"};pi.exports=function(e,r){if(!e||!r)return;let t=r.asymmetricKeyType;if(!t)return;let n=bf[t];if(!n)throw new Error(`Unknown key type "${t}".`);if(!n.includes(e))throw new Error(`"alg" parameter for "${t}" key type must be one of: ${n.join(", ")}.`);if(Sf)switch(t){case"ec":let s=r.asymmetricKeyDetails.namedCurve,i=If[e];if(s!==i)throw new Error(`"alg" parameter "${e}" requires curve "${i}".`);break;case"rsa-pss":if(wf){let o=parseInt(e.slice(-3),10),{hashAlgorithm:a,mgf1HashAlgorithm:c,saltLength:u}=r.asymmetricKeyDetails;if(a!==`sha${o}`||c!==a)throw new Error(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}.`);if(u!==void 0&&u>o>>3)throw new Error(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}.`)}break}}});var Kr=h((ld,di)=>{var Tf=er();di.exports=Tf.satisfies(process.version,"^6.12.0 || >=8.0.0")});var gi=h((hd,Ei)=>{var S=Ee(),Rf=vr(),mi=Sr(),Af=yr(),xf=wr(),$f=Ur(),Nf=Kr(),Lf=Ve(),{KeyObject:Of,createSecretKey:qf,createPublicKey:_f}=require("crypto"),Mr=["RS256","RS384","RS512"],jf=["ES256","ES384","ES512"],Hr=["RS256","RS384","RS512"],Df=["HS256","HS384","HS512"];Nf&&(Mr.splice(Mr.length,0,"PS256","PS384","PS512"),Hr.splice(Hr.length,0,"PS256","PS384","PS512"));Ei.exports=function(e,r,t,n){typeof t=="function"&&!n&&(n=t,t={}),t||(t={}),t=Object.assign({},t);let s;if(n?s=n:s=function(l,f){if(l)throw l;return f},t.clockTimestamp&&typeof t.clockTimestamp!="number")return s(new S("clockTimestamp must be a number"));if(t.nonce!==void 0&&(typeof t.nonce!="string"||t.nonce.trim()===""))return s(new S("nonce must be a non-empty string"));if(t.allowInvalidAsymmetricKeyTypes!==void 0&&typeof t.allowInvalidAsymmetricKeyTypes!="boolean")return s(new S("allowInvalidAsymmetricKeyTypes must be a boolean"));let i=t.clockTimestamp||Math.floor(Date.now()/1e3);if(!e)return s(new S("jwt must be provided"));if(typeof e!="string")return s(new S("jwt must be a string"));let o=e.split(".");if(o.length!==3)return s(new S("jwt malformed"));let a;try{a=Af(e,{complete:!0})}catch(l){return s(l)}if(!a)return s(new S("invalid token"));let c=a.header,u;if(typeof r=="function"){if(!n)return s(new S("verify must be called asynchronous if secret or public key is provided as a callback"));u=r}else u=function(l,f){return f(null,r)};return u(c,function(l,f){if(l)return s(new S("error in secret or public key callback: "+l.message));let g=o[2].trim()!=="";if(!g&&f)return s(new S("jwt signature is required"));if(g&&!f)return s(new S("secret or public key must be provided"));if(!g&&!t.algorithms)return s(new S('please specify "none" in "algorithms" to verify unsigned tokens'));if(f!=null&&!(f instanceof Of))try{f=_f(f)}catch(N){try{f=qf(typeof f=="string"?Buffer.from(f):f)}catch(to){return s(new S("secretOrPublicKey is not valid key material"))}}if(t.algorithms||(f.type==="secret"?t.algorithms=Df:["rsa","rsa-pss"].includes(f.asymmetricKeyType)?t.algorithms=Hr:f.asymmetricKeyType==="ec"?t.algorithms=jf:t.algorithms=Mr),t.algorithms.indexOf(a.header.alg)===-1)return s(new S("invalid algorithm"));if(c.alg.startsWith("HS")&&f.type!=="secret")return s(new S(`secretOrPublicKey must be a symmetric key when using ${c.alg}`));if(/^(?:RS|PS|ES)/.test(c.alg)&&f.type!=="public")return s(new S(`secretOrPublicKey must be an asymmetric key when using ${c.alg}`));if(!t.allowInvalidAsymmetricKeyTypes)try{$f(c.alg,f)}catch(N){return s(N)}let m;try{m=Lf.verify(e,a.header.alg,f)}catch(N){return s(N)}if(!m)return s(new S("invalid signature"));let b=a.payload;if(typeof b.nbf!="undefined"&&!t.ignoreNotBefore){if(typeof b.nbf!="number")return s(new S("invalid nbf value"));if(b.nbf>i+(t.clockTolerance||0))return s(new Rf("jwt not active",new Date(b.nbf*1e3)))}if(typeof b.exp!="undefined"&&!t.ignoreExpiration){if(typeof b.exp!="number")return s(new S("invalid exp value"));if(i>=b.exp+(t.clockTolerance||0))return s(new mi("jwt expired",new Date(b.exp*1e3)))}if(t.audience){let N=Array.isArray(t.audience)?t.audience:[t.audience];if(!(Array.isArray(b.aud)?b.aud:[b.aud]).some(function(et){return N.some(function(sr){return sr instanceof RegExp?sr.test(et):sr===et})}))return s(new S("jwt audience invalid. expected: "+N.join(" or ")))}if(t.issuer&&(typeof t.issuer=="string"&&b.iss!==t.issuer||Array.isArray(t.issuer)&&t.issuer.indexOf(b.iss)===-1))return s(new S("jwt issuer invalid. expected: "+t.issuer));if(t.subject&&b.sub!==t.subject)return s(new S("jwt subject invalid. expected: "+t.subject));if(t.jwtid&&b.jti!==t.jwtid)return s(new S("jwt jwtid invalid. expected: "+t.jwtid));if(t.nonce&&b.nonce!==t.nonce)return s(new S("jwt nonce invalid. expected: "+t.nonce));if(t.maxAge){if(typeof b.iat!="number")return s(new S("iat required when maxAge is specified"));let N=xf(t.maxAge,b.iat);if(typeof N=="undefined")return s(new S('"maxAge" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'));if(i>=N+(t.clockTolerance||0))return s(new mi("maxAge exceeded",new Date(N*1e3)))}if(t.complete===!0){let N=a.signature;return s(null,{header:c,payload:b,signature:N})}return s(null,b)})}});var Ii=h((pd,bi)=>{var yi=1/0,Si=9007199254740991,Pf=17976931348623157e292,vi=0/0,Cf="[object Arguments]",Vf="[object Function]",Bf="[object GeneratorFunction]",Gf="[object String]",kf="[object Symbol]",Ff=/^\s+|\s+$/g,Uf=/^[-+]0x[0-9a-f]+$/i,Kf=/^0b[01]+$/i,Mf=/^0o[0-7]+$/i,Hf=/^(?:0|[1-9]\d*)$/,Xf=parseInt;function Wf(e,r){for(var t=-1,n=e?e.length:0,s=Array(n);++t<n;)s[t]=r(e[t],t,e);return s}function Yf(e,r,t,n){for(var s=e.length,i=t+(n?1:-1);n?i--:++i<s;)if(r(e[i],i,e))return i;return-1}function Jf(e,r,t){if(r!==r)return Yf(e,zf,t);for(var n=t-1,s=e.length;++n<s;)if(e[n]===r)return n;return-1}function zf(e){return e!==e}function Qf(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}function Zf(e,r){return Wf(r,function(t){return e[t]})}function el(e,r){return function(t){return e(r(t))}}var rr=Object.prototype,Wr=rr.hasOwnProperty,tr=rr.toString,rl=rr.propertyIsEnumerable,tl=el(Object.keys,Object),nl=Math.max;function sl(e,r){var t=wi(e)||ul(e)?Qf(e.length,String):[],n=t.length,s=!!n;for(var i in e)(r||Wr.call(e,i))&&!(s&&(i=="length"||ol(i,n)))&&t.push(i);return t}function il(e){if(!al(e))return tl(e);var r=[];for(var t in Object(e))Wr.call(e,t)&&t!="constructor"&&r.push(t);return r}function ol(e,r){return r=r==null?Si:r,!!r&&(typeof e=="number"||Hf.test(e))&&e>-1&&e%1==0&&e<r}function al(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||rr;return e===t}function cl(e,r,t,n){e=Yr(e)?e:vl(e),t=t&&!n?El(t):0;var s=e.length;return t<0&&(t=nl(s+t,0)),pl(e)?t<=s&&e.indexOf(r,t)>-1:!!s&&Jf(e,r,t)>-1}function ul(e){return fl(e)&&Wr.call(e,"callee")&&(!rl.call(e,"callee")||tr.call(e)==Cf)}var wi=Array.isArray;function Yr(e){return e!=null&&hl(e.length)&&!ll(e)}function fl(e){return Jr(e)&&Yr(e)}function ll(e){var r=Xr(e)?tr.call(e):"";return r==Vf||r==Bf}function hl(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Si}function Xr(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function Jr(e){return!!e&&typeof e=="object"}function pl(e){return typeof e=="string"||!wi(e)&&Jr(e)&&tr.call(e)==Gf}function dl(e){return typeof e=="symbol"||Jr(e)&&tr.call(e)==kf}function ml(e){if(!e)return e===0?e:0;if(e=gl(e),e===yi||e===-yi){var r=e<0?-1:1;return r*Pf}return e===e?e:0}function El(e){var r=ml(e),t=r%1;return r===r?t?r-t:r:0}function gl(e){if(typeof e=="number")return e;if(dl(e))return vi;if(Xr(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=Xr(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ff,"");var t=Kf.test(e);return t||Mf.test(e)?Xf(e.slice(2),t?2:8):Uf.test(e)?vi:+e}function yl(e){return Yr(e)?sl(e):il(e)}function vl(e){return e?Zf(e,yl(e)):[]}bi.exports=cl});var Ri=h((dd,Ti)=>{var Sl="[object Boolean]",wl=Object.prototype,bl=wl.toString;function Il(e){return e===!0||e===!1||Tl(e)&&bl.call(e)==Sl}function Tl(e){return!!e&&typeof e=="object"}Ti.exports=Il});var Li=h((md,Ni)=>{var Ai=1/0,Rl=17976931348623157e292,xi=0/0,Al="[object Symbol]",xl=/^\s+|\s+$/g,$l=/^[-+]0x[0-9a-f]+$/i,Nl=/^0b[01]+$/i,Ll=/^0o[0-7]+$/i,Ol=parseInt,ql=Object.prototype,_l=ql.toString;function jl(e){return typeof e=="number"&&e==Vl(e)}function $i(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function Dl(e){return!!e&&typeof e=="object"}function Pl(e){return typeof e=="symbol"||Dl(e)&&_l.call(e)==Al}function Cl(e){if(!e)return e===0?e:0;if(e=Bl(e),e===Ai||e===-Ai){var r=e<0?-1:1;return r*Rl}return e===e?e:0}function Vl(e){var r=Cl(e),t=r%1;return r===r?t?r-t:r:0}function Bl(e){if(typeof e=="number")return e;if(Pl(e))return xi;if($i(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=$i(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(xl,"");var t=Nl.test(e);return t||Ll.test(e)?Ol(e.slice(2),t?2:8):$l.test(e)?xi:+e}Ni.exports=jl});var qi=h((Ed,Oi)=>{var Gl="[object Number]",kl=Object.prototype,Fl=kl.toString;function Ul(e){return!!e&&typeof e=="object"}function Kl(e){return typeof e=="number"||Ul(e)&&Fl.call(e)==Gl}Oi.exports=Kl});var Pi=h((gd,Di)=>{var Ml="[object Object]";function Hl(e){var r=!1;if(e!=null&&typeof e.toString!="function")try{r=!!(e+"")}catch(t){}return r}function Xl(e,r){return function(t){return e(r(t))}}var Wl=Function.prototype,_i=Object.prototype,ji=Wl.toString,Yl=_i.hasOwnProperty,Jl=ji.call(Object),zl=_i.toString,Ql=Xl(Object.getPrototypeOf,Object);function Zl(e){return!!e&&typeof e=="object"}function eh(e){if(!Zl(e)||zl.call(e)!=Ml||Hl(e))return!1;var r=Ql(e);if(r===null)return!0;var t=Yl.call(r,"constructor")&&r.constructor;return typeof t=="function"&&t instanceof t&&ji.call(t)==Jl}Di.exports=eh});var Vi=h((yd,Ci)=>{var rh="[object String]",th=Object.prototype,nh=th.toString,sh=Array.isArray;function ih(e){return!!e&&typeof e=="object"}function oh(e){return typeof e=="string"||!sh(e)&&ih(e)&&nh.call(e)==rh}Ci.exports=oh});var Ui=h((vd,Fi)=>{var ah="Expected a function",Bi=1/0,ch=17976931348623157e292,Gi=0/0,uh="[object Symbol]",fh=/^\s+|\s+$/g,lh=/^[-+]0x[0-9a-f]+$/i,hh=/^0b[01]+$/i,ph=/^0o[0-7]+$/i,dh=parseInt,mh=Object.prototype,Eh=mh.toString;function gh(e,r){var t;if(typeof r!="function")throw new TypeError(ah);return e=bh(e),function(){return--e>0&&(t=r.apply(this,arguments)),e<=1&&(r=void 0),t}}function yh(e){return gh(2,e)}function ki(e){var r=typeof e;return!!e&&(r=="object"||r=="function")}function vh(e){return!!e&&typeof e=="object"}function Sh(e){return typeof e=="symbol"||vh(e)&&Eh.call(e)==uh}function wh(e){if(!e)return e===0?e:0;if(e=Ih(e),e===Bi||e===-Bi){var r=e<0?-1:1;return r*ch}return e===e?e:0}function bh(e){var r=wh(e),t=r%1;return r===r?t?r-t:r:0}function Ih(e){if(typeof e=="number")return e;if(Sh(e))return Gi;if(ki(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ki(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=e.replace(fh,"");var t=hh.test(e);return t||ph.test(e)?dh(e.slice(2),t?2:8):lh.test(e)?Gi:+e}Fi.exports=yh});var Qi=h((Sd,zi)=>{var Ki=wr(),Th=Kr(),Rh=Ur(),Mi=Ve(),Ah=Ii(),nr=Ri(),Hi=Li(),zr=qi(),Wi=Pi(),M=Vi(),xh=Ui(),{KeyObject:$h,createSecretKey:Nh,createPrivateKey:Lh}=require("crypto"),Yi=["RS256","RS384","RS512","ES256","ES384","ES512","HS256","HS384","HS512","none"];Th&&Yi.splice(3,0,"PS256","PS384","PS512");var Oh={expiresIn:{isValid:function(e){return Hi(e)||M(e)&&e},message:'"expiresIn" should be a number of seconds or string representing a timespan'},notBefore:{isValid:function(e){return Hi(e)||M(e)&&e},message:'"notBefore" should be a number of seconds or string representing a timespan'},audience:{isValid:function(e){return M(e)||Array.isArray(e)},message:'"audience" must be a string or array'},algorithm:{isValid:Ah.bind(null,Yi),message:'"algorithm" must be a valid string enum value'},header:{isValid:Wi,message:'"header" must be an object'},encoding:{isValid:M,message:'"encoding" must be a string'},issuer:{isValid:M,message:'"issuer" must be a string'},subject:{isValid:M,message:'"subject" must be a string'},jwtid:{isValid:M,message:'"jwtid" must be a string'},noTimestamp:{isValid:nr,message:'"noTimestamp" must be a boolean'},keyid:{isValid:M,message:'"keyid" must be a string'},mutatePayload:{isValid:nr,message:'"mutatePayload" must be a boolean'},allowInsecureKeySizes:{isValid:nr,message:'"allowInsecureKeySizes" must be a boolean'},allowInvalidAsymmetricKeyTypes:{isValid:nr,message:'"allowInvalidAsymmetricKeyTypes" must be a boolean'}},qh={iat:{isValid:zr,message:'"iat" should be a number of seconds'},exp:{isValid:zr,message:'"exp" should be a number of seconds'},nbf:{isValid:zr,message:'"nbf" should be a number of seconds'}};function Ji(e,r,t,n){if(!Wi(t))throw new Error('Expected "'+n+'" to be a plain object.');Object.keys(t).forEach(function(s){let i=e[s];if(!i){if(!r)throw new Error('"'+s+'" is not allowed in "'+n+'"');return}if(!i.isValid(t[s]))throw new Error(i.message)})}function _h(e){return Ji(Oh,!1,e,"options")}function jh(e){return Ji(qh,!0,e,"payload")}var Xi={audience:"aud",issuer:"iss",subject:"sub",jwtid:"jti"},Dh=["expiresIn","notBefore","noTimestamp","audience","issuer","subject","jwtid"];zi.exports=function(e,r,t,n){typeof t=="function"?(n=t,t={}):t=t||{};let s=typeof e=="object"&&!Buffer.isBuffer(e),i=Object.assign({alg:t.algorithm||"HS256",typ:s?"JWT":void 0,kid:t.keyid},t.header);function o(u){if(n)return n(u);throw u}if(!r&&t.algorithm!=="none")return o(new Error("secretOrPrivateKey must have a value"));if(r!=null&&!(r instanceof $h))try{r=Lh(r)}catch(u){try{r=Nh(typeof r=="string"?Buffer.from(r):r)}catch(l){return o(new Error("secretOrPrivateKey is not valid key material"))}}if(i.alg.startsWith("HS")&&r.type!=="secret")return o(new Error(`secretOrPrivateKey must be a symmetric key when using ${i.alg}`));if(/^(?:RS|PS|ES)/.test(i.alg)){if(r.type!=="private")return o(new Error(`secretOrPrivateKey must be an asymmetric key when using ${i.alg}`));if(!t.allowInsecureKeySizes&&!i.alg.startsWith("ES")&&r.asymmetricKeyDetails!==void 0&&r.asymmetricKeyDetails.modulusLength<2048)return o(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`))}if(typeof e=="undefined")return o(new Error("payload is required"));if(s){try{jh(e)}catch(u){return o(u)}t.mutatePayload||(e=Object.assign({},e))}else{let u=Dh.filter(function(l){return typeof t[l]!="undefined"});if(u.length>0)return o(new Error("invalid "+u.join(",")+" option for "+typeof e+" payload"))}if(typeof e.exp!="undefined"&&typeof t.expiresIn!="undefined")return o(new Error('Bad "options.expiresIn" option the payload already has an "exp" property.'));if(typeof e.nbf!="undefined"&&typeof t.notBefore!="undefined")return o(new Error('Bad "options.notBefore" option the payload already has an "nbf" property.'));try{_h(t)}catch(u){return o(u)}if(!t.allowInvalidAsymmetricKeyTypes)try{Rh(i.alg,r)}catch(u){return o(u)}let a=e.iat||Math.floor(Date.now()/1e3);if(t.noTimestamp?delete e.iat:s&&(e.iat=a),typeof t.notBefore!="undefined"){try{e.nbf=Ki(t.notBefore,a)}catch(u){return o(u)}if(typeof e.nbf=="undefined")return o(new Error('"notBefore" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}if(typeof t.expiresIn!="undefined"&&typeof e=="object"){try{e.exp=Ki(t.expiresIn,a)}catch(u){return o(u)}if(typeof e.exp=="undefined")return o(new Error('"expiresIn" should be a number of seconds or string representing a timespan eg: "1d", "20h", 60'))}Object.keys(Xi).forEach(function(u){let l=Xi[u];if(typeof t[u]!="undefined"){if(typeof e[l]!="undefined")return o(new Error('Bad "options.'+u+'" option. The payload already has an "'+l+'" property.'));e[l]=t[u]}});let c=t.encoding||"utf8";if(typeof n=="function")n=n&&xh(n),Mi.createSign({header:i,privateKey:r,payload:e,encoding:c}).once("error",n).once("done",function(u){if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)return n(new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`));n(null,u)});else{let u=Mi.sign({header:i,payload:e,secret:r,encoding:c});if(!t.allowInsecureKeySizes&&/^(?:RS|PS)/.test(i.alg)&&u.length<256)throw new Error(`secretOrPrivateKey has a minimum key size of 2048 bits for ${i.alg}`);return u}}});var eo=h((wd,Zi)=>{Zi.exports={decode:yr(),verify:gi(),sign:Qi(),JsonWebTokenError:Ee(),NotBeforeError:vr(),TokenExpiredError:Sr()}});var Fh={};fo(Fh,{create:()=>Vh,deactivateExpired:()=>Bh,deleted:()=>Ph,list:()=>kh,redirect:()=>Gh,update:()=>Ch});module.exports=lo(Fh);var ht=ir(lt());ht.config();var Ae=process.env.ACCESS_ID_TOKEN,xe=process.env.SECRET_TOKEN,$e=process.env.JWT_SECRET,Xh=process.env.EXPIRES_IN,pt=process.env.SQS_URL,Wh=process.env.REFRESH_TOKEN_SECRET;var U=ir(require("aws-sdk"));var dt=new U.SQS({apiVersion:"2012-11-05",region:"us-west-1",credentials:{accessKeyId:Ae,secretAccessKey:xe}});U.config.update({accessKeyId:Ae,secretAccessKey:xe,region:"us-west-1"});var zh=new U.SES,L=new U.DynamoDB.DocumentClient({region:"localhost",credentials:{accessKeyId:Ae,secretAccessKey:xe},endpoint:"http://localhost:8000/"}),Q={scan(e){return v(this,null,function*(){let r={TableName:e},t=yield L.scan(r).promise();if(!t||!t.Items)throw Error(`There was an error scanning the table ${e}`);return t.Items})},query(e,r,t){return v(this,null,function*(){let n={TableName:t,KeyConditionExpression:"#k = :v",ExpressionAttributeNames:{"#k":e},ExpressionAttributeValues:{":v":r}},s=yield L.query(n).promise();if(!s||!s.Items)throw Error(`There was an error querying the table ${t}`);return s.Items})},update(e,r,t,n,s){return v(this,null,function*(){let i={TableName:s,Key:{[e]:r},ExpressionAttributeNames:{"#k":t},ExpressionAttributeValues:{":v":n},UpdateExpression:"SET #k = :v",ReturnValues:"ALL_NEW"},o=yield L.update(i).promise();if(!o)throw Error(`There was an error updating the item in table ${s}`);return o.Attributes})},get(e,r,t){return v(this,null,function*(){let n={TableName:t,Key:{[e]:r}},s=yield L.get(n).promise();return console.log(s,"data"),s.Item?s.Item:{result:"No item found"}})},delete(e,r,t){return v(this,null,function*(){let n={TableName:t,Key:{[e]:r}};if(!(yield L.delete(n).promise()))throw Error(`There was an error deleting ${r} from ${t}`);return{result:"Successfully deleted"}})},write(e,r){return v(this,null,function*(){let t={TableName:r,Item:e};return console.log({data:e},"params"),yield L.put(t).promise(),e})}};var T={_DefineResponse(e=502,r={}){return{headers:{"Content-Type":"application/json","Access-Control-Allow-Methods":"*","Access-Control-Allow-Origin":"*"},statusCode:e,body:JSON.stringify(r)}},_Redirect(e=302,r={}){return{headers:{"Content-Type":"application/json","Access-Control-Allow-Methods":"*","Access-Control-Allow-Origin":"*",Location:r},statusCode:e,body:""}},_200(e={}){return this._DefineResponse(200,e)},_204(e={}){return this._DefineResponse(204,e)},_400(e={}){return this._DefineResponse(400,e)},_404(e={}){return this._DefineResponse(404,e)},_401(e={}){return this._DefineResponse(401,e)},_201(e={}){return this._DefineResponse(201,e)},_302(e={}){return this._DefineResponse(302,e)},_500(e={}){return this._DefineResponse(500,e)}};var le=ir(eo());function Qr(e){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}var F={createLink:e=>v(void 0,null,function*(){try{yield L.put({TableName:"links-table",Item:e}).promise()}catch(r){throw console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u0441\u0441\u044B\u043B\u043A\u0438:",r),r}}),getLinksById:e=>v(void 0,null,function*(){let r={TableName:"links-table"},t=yield L.scan(r).promise();console.log(t),console.log(t.Items);let n=t.Items.find(s=>s.id===e);return console.log(n),n}),updateLink:(e,r,t,n)=>v(void 0,null,function*(){let s={TableName:"links-table",Key:{userId:r,id:e},UpdateExpression:"set #attr = :value",ExpressionAttributeNames:{"#attr":t},ExpressionAttributeValues:{":value":n},ReturnValues:"UPDATED_NEW"};return yield L.update(s).promise()}),updateMany:e=>v(void 0,null,function*(){console.log({link:e});let r=Object.keys(e).filter(o=>o!=="userId"&&o!=="id"),t=r.map(o=>`#${o} = :${o}`),n=r.reduce((o,a)=>(o[`#${a}`]=a,o),{}),s=r.reduce((o,a)=>(o[`:${a}`]=e[a],o),{}),i={TableName:"links-table",Key:{id:e.id,userId:e.userId},UpdateExpression:`SET ${t.join(", ")}`,ExpressionAttributeNames:n,ExpressionAttributeValues:s,ReturnValues:"UPDATED_NEW"};yield L.update(i).promise()}),deactivateLink:(e,r)=>v(void 0,null,function*(){let t={TableName:"links-table",Key:{userId:r,id:e},UpdateExpression:"set #attr = :value",ExpressionAttributeNames:{"#attr":"active"},ExpressionAttributeValues:{":value":!1},ReturnValues:"UPDATED_NEW"};yield L.update(t).promise()}),getAllByUserId:e=>v(void 0,null,function*(){let r={TableName:"links-table",FilterExpression:"#userId = :userIdValue",ExpressionAttributeNames:{"#userId":"userId"},ExpressionAttributeValues:{":userIdValue":e}},t=yield L.scan(r).promise();return console.log(t),t.Items}),delete(e,r,t){return v(this,null,function*(){let n={TableName:t,Key:{userId:e,id:r}};return yield L.delete(n).promise(),{status:!0}})}},ro="http://localhost:3000/links/",Zr=class{deleteLink(r,t,n){return v(this,null,function*(){let s=r.pathParameters.id;console.log(s);let i=r.headers.authorization.replace("Bearer ",""),o=yield le.decode(i);o||n(null,T._401({message:"Unauthorized"}));let c=(yield Q.get("email",o.email,"users-table")).id,u=yield F.getLinksById(s);if(!u)return n(null,T._404({message:"Link not found"}));if(u.userId!==c)return n(null,T._401({message:"Unauthorized"}));yield F.delete(u.userId,s,"links-table"),n(null,T._204({message:"Link deleted successfully"}))})}create(r,t,n){return v(this,null,function*(){t.callbackWaitsForEmptyEventLoop=!1;let s=r.headers.authorization.replace("Bearer ","");s||n(null,T._401({message:"Unauthorized empty token"}));let i=JSON.parse(r.body);if(!i.originalLink||!i.lifetime)return n(null,T._400({message:"Invalid data | originalLink, lifetime are required"}));let o=yield le.verify(s,$e),a=Qr(6),c;switch(i.lifetime){case"1h":c=60*4*1e3;break;case"one-time":c=0;break;case"1d":c=60*24*60*60*1e3;break;case"3d":c=3*24*60*60*1e3;break;case"7d":c=7*24*60*60*1e3;break;default:c=7*24*60*60*1e3}console.log(o);let u=yield Q.get("email",o.email,"users-table");if(console.log(u),u.result)return n(null,T._400({message:"User not found"}));let l=u.id,f={id:`${a}`,fullLink:`${ro}${a}`,originalLink:i.originalLink,userId:l,expirationTime:Date.now()+c,active:!0,oneTime:i.lifetime==="one-time",visits:0};yield F.createLink(f),n(null,T._200({message:"Link created successfully",data:f}))})}deactivate(r,t){return v(this,null,function*(){let n=yield F.deactivateLink(r,t);console.log(n)})}redirectLink(r,t,n){return v(this,null,function*(){t.callbackWaitsForEmptyEventLoop=!1;let s=r.pathParameters.id,i=yield F.getLinksById(s);console.log({link:i}),(!i||!i.active||i.expirationTime<Date.now()&&!i.oneTime)&&(yield this.deactivate(s,i.userId),n(null,T._404({message:"Link deactivated or not found"}))),i.oneTime&&(yield this.deactivate(s,i.userId));let o=yield F.updateLink(s,i.userId,"visits",i.visits+1);n(null,T._Redirect(301,i.originalLink))})}deactivateExpired(r,t,n){return v(this,null,function*(){try{let i=(yield Q.scan("links-table")).filter(o=>o.expirationTime<Date.now());for(let o of i){yield Q.update("id",o.id,"active",{active:!1},"links-table");let a={QueueUrl:pt,MessageBody:`Your link is expired now link id:${o.id} , original link ${o.originalLink}`};yield dt.sendMessage(a).promise()}}catch(s){n(null,T._400({message:"Error"}))}})}list(r,t,n){return v(this,null,function*(){t.callbackWaitsForEmptyEventLoop=!1;let s=r.headers.authorization.replace("Bearer ","");s.length||n(null,T._401({message:"Unauthorized empty token"}));let i=le.verify(s,$e),a=(yield F.getAllByUserId(i.id)).map(c=>it(st({},c),{visits:c.visits||0}));n(null,T._200({links:a}))})}update(r,t,n){return v(this,null,function*(){t.callbackWaitsForEmptyEventLoop=!1;let s=r.pathParameters.id,i=r.headers.authorization.replace("Bearer ","");i.length||n(null,T._401({message:"Unauthorized empty token"}));let o=le.verify(i,$e),a=JSON.parse(r.body);if(!a.originalLink||!a.lifetime)return n(null,T._400({message:"Invalid data | originalLink, lifetime are required"}));let c=Qr(6),u;switch(a.lifetime){case"30m":u=60*4*1e3;break;case"one-time":u=0;break;case"1d":u=60*24*60*60*1e3;break;case"3d":u=3*24*60*60*1e3;break;case"7d":u=7*24*60*60*1e3;break;default:u=7*24*60*60*1e3}let l=yield Q.get("email",o.email,"users-table");if(l.result)return n(null,T._400({message:"User not found"}));let f=l.id,g={id:`${c}`,fullLink:`${ro}${c}`,originalLink:a.originalLink,userId:f,expirationTime:Date.now()+u,active:!0,oneTime:a.lifetime==="one-time",visits:0};yield F.delete(g.userId,s,"links-table"),yield F.updateMany(g),n(null,T._200({message:"Link updated successfully",data:g}))})}},z=new Zr;var Ph=(e,r,t)=>v(void 0,null,function*(){yield z.deleteLink(e,r,t)}),Ch=(e,r,t)=>v(void 0,null,function*(){yield z.update(e,r,t)}),Vh=(e,r,t)=>v(void 0,null,function*(){yield z.create(e,r,t)}),Bh=(e,r,t)=>v(void 0,null,function*(){yield z.deactivateExpired(e,r,t)}),Gh=(e,r,t)=>v(void 0,null,function*(){yield z.redirectLink(e,r,t)}),kh=(e,r,t)=>v(void 0,null,function*(){yield z.list(e,r,t)});0&&(module.exports={create,deactivateExpired,deleted,list,redirect,update});
//# sourceMappingURL=links.js.map
